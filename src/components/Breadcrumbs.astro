---
/**
 * Breadcrumbs.astro
 * Auto builds crumbs from the current URL, e.g., /services/digital-marketing
 * Usage:
 *   <Breadcrumbs />
 *   <Breadcrumbs labels={{ services: "Services", "digital-marketing": "Digital Marketing" }} />
 */
export interface Props {
  labels?: Record<string, string>; // optional overrides for segment labels
}

const { labels = {} } = Astro.props;

// Build segments from the current path
const pathname = Astro.url.pathname.replace(/\/+/g, "/"); // normalize
const rawSegments = pathname.split("/").filter(Boolean);

// Build cumulative hrefs for each segment
type Crumb = { label: string; href: string; isLast: boolean };

function toTitleCase(slug: string): string {
  return slug
    .replace(/-/g, " ")
    .split(" ")
    .filter(Boolean)
    .map(w => w.charAt(0).toUpperCase() + w.slice(1))
    .join(" ");
}

const crumbs: Crumb[] = rawSegments.map((seg, idx) => {
  const href = "/" + rawSegments.slice(0, idx + 1).join("/");
  const label = labels[seg] ?? toTitleCase(seg);
  const isLast = idx === rawSegments.length - 1;
  return { label, href, isLast };
});
---

<div class="bc-wrap">
  <div class="container">
    <nav aria-label="Breadcrumb">
      <ol>
        <!-- Home -->
        <li>
          <a href="/">Home</a>
          {rawSegments.length > 0 && <span class="sep">›</span>}
        </li>

        <!-- Dynamic segments -->
        {crumbs.map(c => (
          <li>
            {c.isLast ? (
              <span class="current">{c.label}</span>
            ) : (
              <>
                <a href={c.href}>{c.label}</a>
                <span class="sep">›</span>
              </>
            )}
          </li>
        ))}
      </ol>
    </nav>
  </div>
</div>